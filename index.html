<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¾èªå–®å­—å·¦å³å°æˆ°</title>
    <style>
        :root {
            --p1-bg: #e3f2fd; --p1-color: #1565c0;
            --p2-bg: #ffebee; --p2-color: #c62828;
        }
        body, html {
            margin: 0; padding: 0; height: 100%; width: 100%;
            overflow: hidden; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: #333; touch-action: none; /* ç¦æ­¢ç€è¦½å™¨é è¨­æ‰‹å‹¢ */
        }

        /* ä¸»å®¹å™¨ï¼šå·¦å³åˆ†å‰² */
        #game-container {
            display: flex;
            flex-direction: row; /* å·¦å³æ’åˆ— */
            height: 100%; width: 100%;
        }

        /* ç©å®¶å€åŸŸé€šç”¨æ¨£å¼ */
        .player-area {
            flex: 1; /* å„ä½” 50% å¯¬åº¦ */
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* å…©åˆ—å–®å­—å¡ */
            grid-template-rows: repeat(3, 1fr);    /* ä¸‰è¡Œå–®å­—å¡ */
            gap: 15px;
            padding: 25px;
            align-items: center;
            justify-items: center;
            position: relative;
        }

        /* å·¦å´ç©å®¶ (P1) */
        #p1-area {
            background-color: var(--p1-bg);
            border-right: 3px solid #555;
        }

        /* å³å´ç©å®¶ (P2) - é—œéµä¿®æ­£ï¼šæ•´å€‹å€åŸŸæ—‹è½‰180åº¦ï¼Œé¢å°P1 */
        #p2-area {
            background-color: var(--p2-bg);
            transform: rotate(180deg); 
        }

        /* å–®å­—å¡ç‰‡æ¨£å¼ */
        .word-card {
            width: 90%; height: 80%;
            background: white;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; font-weight: bold; color: #444;
            box-shadow: 0 5px 0 #bbb;
            cursor: pointer; user-select: none;
            transition: transform 0.1s;
            text-align: center;
            word-break: break-word;
        }
        .word-card:active { transform: translateY(5px); box-shadow: 0 2px 0 #bbb; }

        /* ç­”å°/ç­”éŒ¯å›é¥‹ */
        .correct { background: #4caf50 !important; color: white !important; box-shadow: 0 5px 0 #2e7d32 !important; }
        .wrong { background: #f44336 !important; color: white !important; animation: shake 0.3s; }

        /* ä¸­å¤®æ§åˆ¶é … (æµ®åœ¨æœ€ä¸Šå±¤) */
        #center-ui {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 999; display: flex; flex-direction: column; align-items: center;
            pointer-events: none; /* è®“é»æ“Šç©¿é€åˆ°ä¸‹æ–¹éŠæˆ²å€ */
        }

        /* è¨ˆåˆ†æ¿ */
        .score-board {
            background: rgba(0,0,0,0.85); color: white;
            padding: 12px 30px; border-radius: 50px;
            font-size: 1.5rem; font-weight: bold;
            display: flex; gap: 30px;
            border: 3px solid white;
        }
        .p1-score { color: #90caf9; }
        .p2-score { color: #ef9a9a; }

        /* æ’­æ”¾æŒ‰éˆ• */
        #speaker-btn {
            margin-top: 20px; width: 70px; height: 70px;
            background: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 2rem; cursor: pointer;
            box-shadow: 0 0 20px rgba(255,255,255,0.4);
            pointer-events: auto; /* å•Ÿç”¨æŒ‰éˆ•é»æ“Š */
        }
        #speaker-btn:active { transform: scale(0.95); }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
    </style>
</head>
<body>

<div id="game-container">
    <div id="p1-area" class="player-area"></div>
    <div id="p2-area" class="player-area"></div>
</div>

<div id="center-ui">
    <div class="score-board">
        <span class="p1-score">P1: <span id="s1">0</span></span>
        <span>VS</span>
        <span class="p2-score">P2: <span id="s2">0</span></span>
    </div>
    <div id="speaker-btn">ğŸ”Š</div>
</div>

<script>
    // 1. å–®å­—åº«è¨­å®š (å¯è‡ªè¡Œæ“´å……)
    const vocabulary = [
        {en: 'Apple', zh: 'è˜‹æœ'}, {en: 'Banana', zh: 'é¦™è•‰'},
        {en: 'Orange', zh: 'æŸ³æ©™'}, {en: 'Grape', zh: 'è‘¡è„'},
        {en: 'Watermelon', zh: 'è¥¿ç“œ'}, {en: 'Strawberry', zh: 'è‰è“'},
        {en: 'Lemon', zh: 'æª¸æª¬'}, {en: 'Peach', zh: 'æ¡ƒå­'}
    ];

    let currentTarget = "";
    let scores = { p1: 0, p2: 0 };
    let isProcessing = false; // é˜²æ­¢é‡è¤‡é»æ“Š

    const synth = window.speechSynthesis;
    const speakerBtn = document.getElementById('speaker-btn');

    // 2. èªéŸ³æ’­æ”¾åŠŸèƒ½
    function speakWord() {
        if (!currentTarget || synth.speaking) return;
        const utter = new SpeechSynthesisUtterance(currentTarget);
        utter.lang = 'en-US';
        utter.rate = 0.9; // èªé€Ÿç¨æ…¢
        synth.speak(utter);
    }

    // 3. é–‹å§‹æ–°å›åˆ
    function newRound() {
        isProcessing = false;
        // éš¨æ©Ÿé¸æ“‡ä¸€å€‹ç›®æ¨™å–®å­—
        currentTarget = vocabulary[Math.floor(Math.random() * vocabulary.length)].en;
        
        // æ¸²æŸ“å…©å´å€åŸŸ
        renderCards('p1-area');
        renderCards('p2-area');

        // è‡ªå‹•æ’­æ”¾è²éŸ³ (å»¶é²ä¸€é»é»ä»¥å…åˆ‡æ›å¤ªå¿«è½ä¸åˆ°)
        setTimeout(speakWord, 600);
    }

    // 4. æ¸²æŸ“å–®å­—å¡ç‰‡
    function renderCards(areaId) {
        const container = document.getElementById(areaId);
        container.innerHTML = "";
        
        // éš¨æ©Ÿæ‰“äº‚å–®å­—é †åº
        const shuffledList = [...vocabulary].sort(() => 0.5 - Math.random()).slice(0, 6); // å–å‰6å€‹é¡¯ç¤º

        // ç¢ºä¿ç›®æ¨™å–®å­—ä¸€å®šåœ¨åˆ—è¡¨ä¸­ (å¦‚æœéš¨æ©Ÿæ²’å–åˆ°çš„è©±)
        const targetExists = shuffledList.some(item => item.en === currentTarget);
        if (!targetExists) {
            shuffledList[0] = vocabulary.find(item => item.en === currentTarget);
        }
        // å†æ¬¡æ‰“äº‚ä»¥éš±è—ç›®æ¨™ä½ç½®
        shuffledList.sort(() => 0.5 - Math.random());

        // å»ºç«‹å¡ç‰‡ DOM
        shuffledList.forEach(item => {
            const card = document.createElement('div');
            card.className = 'word-card';
            card.innerText = item.en;
            // é—œéµï¼šä½¿ç”¨ onpointerdown æ”¯æ´å¤šé»è§¸æ§ï¼Œä¸¦ç¶å®šæª¢æŸ¥å‡½å¼
            card.onpointerdown = (e) => checkAnswer(item.en, areaId, e.currentTarget);
            container.appendChild(card);
        });
    }

    // 5. æª¢æŸ¥ç­”æ¡ˆ
    function checkAnswer(selectedWord, areaId, cardElement) {
        if (isProcessing) return; // é–å®šç‹€æ…‹ä¸è™•ç†

        if (selectedWord === currentTarget) {
            // ç­”å°äº†
            isProcessing = true; // é–å®šï¼Œé˜²æ­¢å¦ä¸€äººåŒæ™‚å¾—åˆ†
            const winner = areaId === 'p1-area' ? 'p1' : 'p2';
            scores[winner]++;
            document.getElementById(winner === 'p1' ? 's1' : 's2').innerText = scores[winner];
            
            // è¦–è¦ºå›é¥‹
            cardElement.classList.add('correct');
            
            // 1.5ç§’å¾Œä¸‹ä¸€é¡Œ
            setTimeout(newRound, 1500);
        } else {
            // ç­”éŒ¯äº†
            cardElement.classList.add('wrong');
            // 0.5ç§’å¾Œç§»é™¤éŒ¯èª¤æ¨£å¼
            setTimeout(() => cardElement.classList.remove('wrong'), 500);
        }
    }

    // äº‹ä»¶ç¶å®š
    speakerBtn.onclick = speakWord;

    // é»æ“Šç•«é¢ä»»ä½•åœ°æ–¹é–‹å§‹éŠæˆ² (åƒ…ç¬¬ä¸€æ¬¡æœ‰æ•ˆ)
    document.body.addEventListener('pointerdown', function startGame() {
        speakerBtn.innerText = "ğŸ”Š"; // æ”¹è®Šåœ–ç¤ºæç¤ºå·²é–‹å§‹
        newRound();
        document.body.removeEventListener('pointerdown', startGame);
    }, { once: true });

    // åˆå§‹æç¤º
    speakerBtn.innerText = "é»æ“Šé–‹å§‹";

</script>
</body>
</html>
